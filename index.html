<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>å¥èº«è¯¾è‡ªå®šä¹‰è§„åˆ’ (æ¢å¤ç¬¬ä¸€ç‰ˆé£æ ¼)</title>
    <style>
        :root {
            --bg-color: #f8f9fa;
            --card-bg: #ffffff;
            --primary: #4a90e2;
            --success: #66bb6a;
            --accent: #ff7043;
            --text: #333;
            --muted: #888;
        }
        body { font-family: "PingFang SC", "Microsoft YaHei", sans-serif; background: var(--bg-color); color: var(--text); padding: 20px; }
        
        /* æ¢å¤ç¬¬ä¸€ç‰ˆå®½æ•çš„å®¹å™¨ */
        .container { max-width: 1000px; margin: 0 auto; }
        .header { text-align: center; margin-bottom: 30px; }
        
        .stats-bar { 
            display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin-bottom: 20px;
        }
        .stat-card { 
            background: var(--card-bg); padding: 20px; border-radius: 12px; text-align: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
        }
        .stat-card div { font-size: 0.9em; color: var(--muted); margin-bottom: 5px; }
        .stat-card strong { font-size: 1.6em; color: var(--primary); }

        /* æ¢å¤ç¬¬ä¸€ç‰ˆæ—¥å†ç½‘æ ¼æ ·å¼ */
        .calendar-grid { 
            display: grid; grid-template-columns: repeat(7, 1fr); gap: 10px; 
            background: var(--card-bg); padding: 20px; border-radius: 15px; 
            box-shadow: 0 10px 25px rgba(0,0,0,0.05);
        }
        .weekday { text-align: center; font-weight: bold; padding: 10px 0; color: var(--muted); border-bottom: 1px solid #eee; }
        
        /* æ¢å¤ç¬¬ä¸€ç‰ˆå¤§æ ¼å­ */
        .day { 
            aspect-ratio: 1/1; border-radius: 8px; border: 1px solid #f0f0f0;
            padding: 10px; cursor: pointer; transition: all 0.2s; position: relative;
            display: flex; flex-direction: column; justify-content: space-between;
            background: #fff;
        }
        .day:hover { background: #f0f7ff; transform: scale(1.02); z-index: 2; border-color: var(--primary); }
        
        /* çŠ¶æ€é«˜äº® */
        .day.today { border: 2px solid var(--accent) !important; }
        .day.today::before { content: "ä»Šå¤©"; position: absolute; top: -12px; left: 50%; transform: translateX(-50%); background: var(--accent); color: white; padding: 2px 6px; font-size: 10px; border-radius: 4px; white-space: nowrap; }
        
        .day[data-status="planned"] { background-color: #e3f2fd; border-color: var(--primary); }
        .day[data-status="done"] { background-color: #e8f5e9; border-color: var(--success); }
        
        .date-num { font-size: 1.1em; font-weight: 600; }
        .class-tag { font-size: 0.9em; font-weight: bold; text-align: right; }
        
        /* é¢œè‰²æ–‡å­—åŒºåˆ† */
        [data-status="planned"] .class-tag { color: var(--primary); }
        [data-status="done"] .class-tag { color: var(--success); }

        .month-divider { grid-column: 1 / span 7; padding: 15px; font-weight: bold; background: #fdfdfd; color: #444; font-size: 1.1em; border-left: 5px solid var(--primary); margin-top: 20px;}
        
        .legend { text-align: center; margin-top: 30px; color: var(--muted); font-size: 0.9em; }
        .dot { display: inline-block; width: 12px; height: 12px; border-radius: 3px; margin-right: 5px; margin-left: 15px; }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <h2>ğŸ“… å¥èº«è¯¾æ’æœŸ (ç¬¬21-36èŠ‚)</h2>
        <p>ç‚¹å‡»åˆ‡æ¢ï¼šç©ºç™½ â†’ ğŸ“… è®¡åˆ’ä¸­ â†’ âœ… å·²å®Œæˆ</p>
    </div>

    <div class="stats-bar">
        <div class="stat-card"><div>ç›®æ ‡æ€»æ•°</div><strong>36 èŠ‚</strong></div>
        <div class="stat-card"><div>ç›®å‰è¿›åº¦</div><strong id="progress-val">0/36</strong></div>
        <div class="stat-card"><div>å‰©ä½™éœ€è§„åˆ’</div><strong id="remain-val" style="color:var(--accent)">15</strong></div>
    </div>

    <div id="calendar" class="calendar-grid">
        <div class="weekday">æ—¥</div><div class="weekday">ä¸€</div><div class="weekday">äºŒ</div>
        <div class="weekday">ä¸‰</div><div class="weekday">å››</div><div class="weekday">äº”</div>
        <div class="weekday">å…­</div>
    </div>

    <div class="legend">
        <i class="dot" style="background:#e8f5e9; border:1px solid var(--success)"></i>å·²å®Œæˆ
        <i class="dot" style="background:#e3f2fd; border:1px solid var(--primary)"></i>è®¡åˆ’ä¸­
        <i class="dot" style="border:1px solid #f0f0f0"></i>æœªæ’è¯¾
    </div>
</div>

<script>
    const CONFIG = {
        total: 36,
        base: 20, // 1.15æ—¥ä¹‹å‰å®Œæˆäº†20èŠ‚
        start: new Date(2026, 0, 1),
        end: new Date(2026, 2, 31)
    };

    const STORAGE_KEY = 'gym_v_final_restored';

    // æ ¼å¼åŒ–æ—¥æœŸä¸º YYYY-MM-DD
    function fmtDate(d) {
        return d.getFullYear() + '-' + String(d.getMonth() + 1).padStart(2, '0') + '-' + String(d.getDate()).padStart(2, '0');
    }

    const todayStr = fmtDate(new Date());
    let schedule = JSON.parse(localStorage.getItem(STORAGE_KEY)) || {};

    // é¦–æ¬¡åˆå§‹åŒ–
    if (Object.keys(schedule).length === 0) {
        schedule[todayStr] = 'done';
    }

    function render() {
        const grid = document.getElementById('calendar');
        const headers = Array.from(grid.querySelectorAll('.weekday'));
        grid.innerHTML = '';
        headers.forEach(h => grid.appendChild(h));

        // ç¼–å·é€»è¾‘
        const sorted = Object.keys(schedule).sort();
        const dateMap = {};
        sorted.forEach((d, i) => dateMap[d] = CONFIG.base + i + 1);

        let cur = new Date(CONFIG.start);
        let curMonth = -1;

        while (cur <= CONFIG.end) {
            const dStr = fmtDate(cur);
            
            if (cur.getMonth() !== curMonth) {
                curMonth = cur.getMonth();
                const div = document.createElement('div');
                div.className = 'month-divider';
                div.innerText = `${cur.getFullYear()}å¹´ ${curMonth + 1}æœˆ`;
                grid.appendChild(div);
                for(let i=0; i<cur.getDay(); i++) grid.appendChild(document.createElement('div'));
            }

            const dayEl = document.createElement('div');
            dayEl.className = 'day';
            if (dStr === todayStr) dayEl.classList.add('today');
            
            const status = schedule[dStr];
            if (status) dayEl.dataset.status = status;

            dayEl.innerHTML = `
                <span class="date-num">${cur.getDate()}</span>
                <span class="class-tag">${status ? 'ç¬¬'+dateMap[dStr]+'èŠ‚' : ''}</span>
            `;

            dayEl.onclick = () => {
                if (!status) schedule[dStr] = 'planned';
                else if (status === 'planned') schedule[dStr] = 'done';
                else delete schedule[dStr];
                localStorage.setItem(STORAGE_KEY, JSON.stringify(schedule));
                render();
            };

            grid.appendChild(dayEl);
            cur.setDate(cur.getDate() + 1);
        }

        // æ›´æ–°ç»Ÿè®¡
        const doneCount = CONFIG.base + Object.values(schedule).filter(s => s === 'done').length;
        const totalPlanned = CONFIG.base + sorted.length;
        document.getElementById('progress-val').innerText = `${doneCount}/36`;
        document.getElementById('remain-val').innerText = Math.max(0, 36 - totalPlanned);
    }

    render();
</script>
</body>
</html>
